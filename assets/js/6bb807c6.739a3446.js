"use strict";(globalThis.webpackChunkmi_sitio=globalThis.webpackChunkmi_sitio||[]).push([[9205],{7202(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"scripting-api/index","title":"4.1) Scripting introduction","description":"---","source":"@site/docs/4-scripting-api/1-index.md","sourceDirName":"4-scripting-api","slug":"/scripting-api/index","permalink":"/docs/scripting-api/index","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"4.1) Scripting introduction"},"sidebar":"tutorialSidebar","previous":{"title":"3.5) Components","permalink":"/docs/engine-concepts/components"},"next":{"title":"4.2) Basic object types","permalink":"/docs/scripting-api/basic-object-types"}}');var s=i(4848),r=i(8453);const c={sidebar_position:1,title:"4.1) Scripting introduction"},a="Scripting introduction",o={},l=[{value:"Main concepts",id:"main-concepts",level:2},{value:"Oriented objects",id:"oriented-objects",level:3},{value:"Script files",id:"script-files",level:3},{value:"Scripting System States",id:"scripting-system-states",level:2},{value:"Scripts LUA",id:"scripts-lua",level:2},{value:"Object scripts",id:"object-scripts",level:3},{value:"Global scripts",id:"global-scripts",level:3},{value:"Object life cycle",id:"object-life-cycle",level:2},{value:"On Start",id:"on-start",level:3},{value:"On Update",id:"on-update",level:3},{value:"Variables",id:"variables",level:2},{value:"Global variables",id:"global-variables",level:3},{value:"Local variables",id:"local-variables",level:3},{value:"Scene Management",id:"scene-management",level:2},{value:"Linking Scripts",id:"linking-scripts",level:2},{value:"Deltatime",id:"deltatime",level:2},{value:"Terminating Execution",id:"terminating-execution",level:2},{value:"Auto-loading Projects or Scenes",id:"auto-loading-projects-or-scenes",level:2},{value:"Components",id:"components",level:2}];function d(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"scripting-introduction",children:"Scripting introduction"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["Although the engine is internally developed in C++ to ensure high performance and efficiency, ",(0,s.jsx)(n.strong,{children:"Brakeza3D"})," provides an ",(0,s.jsx)(n.strong,{children:"API accessible through the LUA language"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Through this abstraction layer, developers can manipulate objects, control behaviors, and manage different aspects of the engine in a simple and flexible way, ",(0,s.jsx)(n.strong,{children:"without directly interacting with native code"}),". This enables rapid iteration, higher productivity, and a more accessible learning curve when creating logic and systems within the engine."]}),"\n",(0,s.jsx)(n.h2,{id:"main-concepts",children:"Main concepts"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"oriented-objects",children:"Oriented objects"}),"\n",(0,s.jsxs)(n.p,{children:["In general, ",(0,s.jsx)(n.strong,{children:"any element that can be displayed on screen is an object"}),", for\nexample: 3D models, lights, particle emitter..."]}),"\n",(0,s.jsxs)(n.p,{children:["All objects ",(0,s.jsx)(n.strong,{children:"share the basic properties"})," of a 3D element, such as name, position, rotation, and scale. ",(0,s.jsx)(n.strong,{children:"Each\nspecific object type can extend these properties as needed."})," From code, we can activate, move, rotate, delete, scale, and perform many other actions on objects."]}),"\n",(0,s.jsx)(n.h3,{id:"script-files",children:"Script files"}),"\n",(0,s.jsxs)(n.p,{children:["The engine supports scripting using ",(0,s.jsx)(n.code,{children:"LUA language"}),", which can be attached to individual objects or entire scenes.\nScripts can be assigned via drag-and-drop directly from the GUI."]}),"\n",(0,s.jsxs)(n.p,{children:["During execution, script variables ",(0,s.jsx)(n.strong,{children:"can be monitored and modified in real time"}),", allowing for efficient\ndebugging and behavior tuning without recompilation."]}),"\n",(0,s.jsx)(n.h2,{id:"scripting-system-states",children:"Scripting System States"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["In the main loop of ",(0,s.jsx)(n.strong,{children:"Brakeza3D"}),", a series of actions are executed continuously. One of them is the scripting system. This system can be in ",(0,s.jsx)(n.code,{children:"ON"})," or ",(0,s.jsx)(n.code,{children:"OFF"}),". If it is ",(0,s.jsx)(n.code,{children:"ON"}),", objects will execute their life cycle as implemented in their scripts."]}),"\n",(0,s.jsxs)(n.p,{children:["You can also ",(0,s.jsx)(n.code,{children:"RELOAD"})," the system to reset scripts and refresh them from disk. Additionally, these states can be controlled directly from the GUI, allowing you to toggle the scripting system or reload scripts without modifying code."]}),"\n",(0,s.jsx)(n.h2,{id:"scripts-lua",children:"Scripts LUA"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"LUA scripts"})," are elements that can be linked to system elements. In them, we implement the logic and behavior\nof objects."]}),"\n",(0,s.jsx)(n.h3,{id:"object-scripts",children:"Object scripts"}),"\n",(0,s.jsx)(n.p,{children:"Associated with objects. The same script can be linked to multiple objects."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Object's scripts ",(0,s.jsx)(n.strong,{children:"instantiate their variables for each object to which they are linked"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"global-scripts",children:"Global scripts"}),"\n",(0,s.jsx)(n.p,{children:"Associated with the scene or project, not with any specific object; they are general in nature."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Global scripts ",(0,s.jsx)(n.strong,{children:"share variables freely among themselves"}),"."]})}),"\n",(0,s.jsxs)(n.p,{children:["The main difference with an object script is the ",(0,s.jsx)(n.em,{children:"scope"})," of their variables."]}),"\n",(0,s.jsx)(n.h2,{id:"object-life-cycle",children:"Object life cycle"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["The objects ",(0,s.jsx)(n.code,{children:"Object3D"})," have their own life cycle in ",(0,s.jsx)(n.code,{children:"LUA Scripts"}),", which is important to understand when working with loaded objects."]}),"\n",(0,s.jsx)(n.h3,{id:"on-start",children:"On Start"}),"\n",(0,s.jsx)(n.p,{children:"The moment execution begins. Triggered when the scripting system is activated (PLAY)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function onStart()\n    -- code to execute at the start of the script, only once\nend\n"})}),"\n",(0,s.jsx)(n.h3,{id:"on-update",children:"On Update"}),"\n",(0,s.jsx)(n.p,{children:"The current moment, i.e., every frame."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"function onUpdate()\n    -- code to execute every frame\nend\n"})}),"\n",(0,s.jsx)(n.h2,{id:"variables",children:"Variables"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"Any LUA script can define variables to help implement logic. The GUI allows easy management of script\nvariables."}),"\n",(0,s.jsx)(n.p,{children:"Physically, variables are stored in a JSON file with the same name as the script."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "name":\t"global_script_example.lua",\n    "types": [\n        {\n          "name": "var1",\n          "type": "string",\n          "value": "hello my friend!"\n        },\n        {\n          "name": "var2",\n          "type": "int",\n          "value": 10\n        },\n        {\n          "name": "var3",\n          "type": "float",\n          "value": 0.3\n        },\n        {\n          "name": "var4",\n          "type": "Vertex3D",\n          "value": {\n            "x": 0,\n            "y": 2,\n            "z": 0\n          }\n        }\n    ]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"You can use the types: int, float, string, and Vertex3D."}),"\n",(0,s.jsx)(n.h3,{id:"global-variables",children:"Global variables"}),"\n",(0,s.jsx)(n.p,{children:"Variables defined in scripts linked to projects and/or scenes are global."}),"\n",(0,s.jsx)(n.p,{children:"You can access global variables directly from any other script:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function onUpdate()\n    var1 = var1 .. "!"                  -- demo global variable\n    print("Value of var1: " .. var1)\nend\n'})}),"\n",(0,s.jsx)(n.h3,{id:"local-variables",children:"Local variables"}),"\n",(0,s.jsxs)(n.p,{children:["Variables defined in scripts linked to ",(0,s.jsx)(n.code,{children:"Object3D"})," are local, meaning they are instantiated individually\nfor each object."]}),"\n",(0,s.jsx)(n.p,{children:"You can access local variables of another object from your LUA scripts as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'o = Brakeza:getSceneObjectByLabel("MyObject")\nposition = o:getLocalScriptVar("offset")                            -- we get a vertex3D!\n\nprint("Read variable \'offset\' from object: ".. o:getName())\nprint("Value for \'offset\': " .. position.x .. ", " .. position.y .. ", " .. position.z)\n\nprint("Read variable \'count\' from object: ".. o:getName())\nprint("Value for \'count\': " .. o:getLocalScriptVar("count"))        -- we get a int!\n'})}),"\n",(0,s.jsx)(n.h2,{id:"scene-management",children:"Scene Management"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"You can load and save scenes from both the GUI and your LUA scripts:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'function onStart()\n    ...\n    Components:Render():getSceneLoader():LoadScene("../scenes/scene_example.json")\n    ...\n    Components:Render():getSceneLoader():SaveScene("../scenes/scene_example.json")\n    ...\nend\n'})}),"\n",(0,s.jsx)(n.h2,{id:"linking-scripts",children:"Linking Scripts"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["You can perform these operations from the ",(0,s.jsx)(n.strong,{children:"UI using drag-and-drop"}),". Specifically, you can link LUA scripts from the GUI to ",(0,s.jsx)(n.em,{children:"projects"}),", ",(0,s.jsx)(n.em,{children:"scenes"}),", or ",(0,s.jsx)(n.em,{children:"individual objects"}),". These links are saved to disk at the scene and/or project level."]}),"\n",(0,s.jsxs)(n.p,{children:["However, sometimes you may want to create these links dynamically from code. You can do it in the following way:  ",(0,s.jsx)(n.code,{children:"Object3D"})," has a method ",(0,s.jsx)(n.code,{children:"AttachScript(ScriptLUA)"})," that allows linking scripts:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'lightpoint = ObjectFactory.LightPoint(\n    Vertex3D.new(10, 20, 30),                               -- position\n    Color.new(0.1, 0.1, 0.1),                               -- ambient component\n    Color.new(0.2, 0.4, 0.6),                               -- diffuse component\n    Color.new(0.5, 0.3, 1.0),                               -- specular component\n);\n\nscript = ObjectFactory.ScriptLUA("../../scripts/MoveForwardObject.lua")\nif script ~= nil then\n    lightp:AttachScript(script)\nend\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Similarly, the component ",(0,s.jsx)(n.code,{children:"Scripting"})," object has ",(0,s.jsx)(n.code,{children:"AddSceneLUAScript()"})," to link a script to the scene:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'script = ObjectFactory.ScriptLUA("../../scripts/global_script.lua")\nif script ~= nil then\n    Components:Scripting():AddSceneLUAScript(script)\nend\n'})}),"\n",(0,s.jsx)(n.p,{children:"Or a project:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'script = ObjectFactory.ScriptLUA("../../scripts/global_script.lua")\nif script ~= nil then\n    Components:Scripting():AddProjectLUAScript(script)\nend\n'})}),"\n",(0,s.jsx)(n.h2,{id:"deltatime",children:"Deltatime"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"DeltaTime is the time it takes to render a frame. It is crucial in game development, as it ensures movements\nand animations are consistent regardless of frame rate."}),"\n",(0,s.jsx)(n.p,{children:"You can access it in your LUA scripts as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'...\nprint("DeltaTime: " .. Brakeza:getDeltaTime())                  -- seconds\nprint("DeltaTimeInMicro: " .. Brakeza:getDeltaTimeMicro())      -- microseconds\nprint("Execution Time: " .. Brakeza:getExecutionTime())         -- total execution time\n...\nfunction onUpdate()\n    local speed = 5.0                                           -- units per second\n    local movement = speed * Brakeza:getDeltaTime()\n    myObject:addToPosition(Vertex3D.new(movement, 0, 0))\nend\n'})}),"\n",(0,s.jsx)(n.h2,{id:"terminating-execution",children:"Terminating Execution"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"If you want to terminate the application from code, you can do so as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:"Brakeza:Shutdown()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"auto-loading-projects-or-scenes",children:"Auto-loading Projects or Scenes"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"When packaging your game or application, you may want Brakeza3D to automatically load and execute scripts\nfrom a specific project. You can instruct Brakeza3D to do this via the command line:"}),"\n",(0,s.jsx)(n.p,{children:"Windows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"> brakeza3d.exe -p MyProject.json \n> brakeza3d.exe --project MyProject.json\n"})}),"\n",(0,s.jsx)(n.p,{children:"This will run the project automatically without the UI."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["The project file path is relative to the base projects directory: ",(0,s.jsx)(n.strong,{children:"/assets/projects/"})]})}),"\n",(0,s.jsx)(n.h2,{id:"components",children:"Components"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Brakeza3D"})," organizes its functionality into components. Each component represents a fundamental aspect of the engine core."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Window"}),": Manages the operating system window"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Scripting"}),": Manages the scripting system"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Camera"}),": Manages the camera"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Collisions"}),": Manages the physics and collision engine"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Input"}),": Manages keyboard or gamepad input"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Sound"}),": Manages sound playback"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Render"}),": Manages rendering with OpenGL"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"You can access all of them through the component manager from your Lua scripts. Each component will be explained in detail later."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>c,x:()=>a});var t=i(6540);const s={},r=t.createContext(s);function c(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);